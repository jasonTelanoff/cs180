<html>

<head>
    <meta content="text/html; charset=UTF-8" http-equiv="content-type">
    <style type="text/css">
        ol {
            margin: 0;
            padding: 0
        }

        table td,
        table th {
            padding: 0
        }

        .c7 {
            color: #666666;
            font-weight: 400;
            text-decoration: none;
            vertical-align: baseline;
            font-size: 15pt;
            font-family: "Arial";
            font-style: normal
        }

        .c4 {
            color: #000000;
            font-weight: 400;
            text-decoration: none;
            vertical-align: baseline;
            font-size: 10pt;
            font-family: "Arial";
            font-style: normal
        }

        .c1 {
            padding-top: 10pt;
            padding-bottom: 6pt;
            line-height: 1.15;
            page-break-after: avoid;
            orphans: 2;
            widows: 2;
            text-align: left
        }

        .c0 {
            color: #000000;
            font-weight: 400;
            text-decoration: none;
            vertical-align: baseline;
            font-size: 12pt;
            font-family: "Arial";
            font-style: normal
        }

        .c6 {
            color: #000000;
            font-weight: 700;
            text-decoration: none;
            vertical-align: baseline;
            font-size: 23pt;
            font-family: "Arial";
            font-style: normal
        }

        .c9 {
            padding-top: 24pt;
            padding-bottom: 6pt;
            line-height: 1.15;
            page-break-after: avoid;
            orphans: 2;
            widows: 2;
            text-align: left
        }

        .c11 {
            padding-top: 24pt;
            padding-bottom: 6pt;
            line-height: 1.15;
            page-break-after: avoid;
            orphans: 2;
            widows: 2;
            text-align: center
        }

        .c2 {
            padding-top: 0pt;
            padding-bottom: 0pt;
            line-height: 1.15;
            orphans: 2;
            widows: 2;
            text-align: left
        }

        .c3 {
            padding-top: 0pt;
            padding-bottom: 0pt;
            line-height: 1.15;
            orphans: 2;
            widows: 2;
            text-align: center
        }

        .c10 {
            background-color: #ffffff;
            max-width: 900pt;
            padding: 72pt 72pt 72pt 72pt
        }

        .c5 {
            height: 12pt
        }

        .c12 {
            font-size: 10pt
        }

        .c8 {
            font-weight: 700
        }

        .title {
            padding-top: 24pt;
            color: #000000;
            font-weight: 700;
            font-size: 23pt;
            padding-bottom: 6pt;
            font-family: "Arial";
            line-height: 1.15;
            page-break-after: avoid;
            orphans: 2;
            widows: 2;
            text-align: center
        }

        .subtitle {
            padding-top: 10pt;
            color: #666666;
            font-size: 15pt;
            padding-bottom: 6pt;
            font-family: "Arial";
            line-height: 1.15;
            page-break-after: avoid;
            orphans: 2;
            widows: 2;
            text-align: left
        }

        li {
            color: #000000;
            font-size: 12pt;
            font-family: "Arial"
        }

        p {
            margin: 0;
            color: #000000;
            font-size: 12pt;
            font-family: "Arial"
        }

        h1 {
            padding-top: 24pt;
            color: #000000;
            font-weight: 700;
            font-size: 23pt;
            padding-bottom: 6pt;
            font-family: "Arial";
            line-height: 1.15;
            page-break-after: avoid;
            orphans: 2;
            widows: 2;
            text-align: left
        }

        h2 {
            padding-top: 18pt;
            color: #000000;
            font-size: 16pt;
            padding-bottom: 6pt;
            font-family: "Arial";
            line-height: 1.15;
            page-break-after: avoid;
            orphans: 2;
            widows: 2;
            text-align: left
        }

        h3 {
            padding-top: 16pt;
            color: #434343;
            font-size: 14pt;
            padding-bottom: 4pt;
            font-family: "Arial";
            line-height: 1.15;
            page-break-after: avoid;
            orphans: 2;
            widows: 2;
            text-align: left
        }

        h4 {
            padding-top: 14pt;
            color: #666666;
            font-size: 12pt;
            padding-bottom: 4pt;
            font-family: "Arial";
            line-height: 1.15;
            page-break-after: avoid;
            orphans: 2;
            widows: 2;
            text-align: left
        }

        h5 {
            padding-top: 12pt;
            color: #666666;
            font-size: 11pt;
            padding-bottom: 4pt;
            font-family: "Arial";
            line-height: 1.15;
            page-break-after: avoid;
            orphans: 2;
            widows: 2;
            text-align: left
        }

        h6 {
            padding-top: 12pt;
            color: #666666;
            font-size: 11pt;
            padding-bottom: 4pt;
            font-family: "Arial";
            line-height: 1.15;
            page-break-after: avoid;
            font-style: italic;
            orphans: 2;
            widows: 2;
            text-align: left
        }
    </style>
</head>

<body class="c10 doc-content">
    <p class="c11 title" id="h.qs8x6o4ibhvj"><span class="c6">Final Project: Neural Radiance Field!</span></p>
    <h1 class="c9" id="h.3733xv4kj4ok"><span class="c6">Part 1: Fit a Neural Field to a 2D Image</span></h1>
    <p class="c2"><span class="c0">To fit a neural field to a 2D image I first needed a neural field. I implemented the
            following net using PyTorch.</span></p>
    <p class="c2 c5"><span class="c0"></span></p>
    <p class="c3"><span
            style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 672.00px; height: 200.29px;"><img
                alt="" src="images/image12.jpg"
                style="width: 672.00px; height: 200.29px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);"
                title=""></span></p>
    <p class="c3 c5"><span class="c0"></span></p>
    <p class="c2"><span>I used the recommended hyperparameters of an Adam optimizer, MSE loss, a learning rate of 1e-2,
            L of 10, 2 hidden layers, a batch size of 10k, and 2k i</span><span class="c0">terations. This gave me the
            following scaled down output image, loss graph, and PSNR graph.</span></p>
    <p class="c3"><span
            style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 496.00px; height: 333.00px;"><img
                alt="" src="images/image2.png"
                style="width: 496.00px; height: 333.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);"
                title=""></span></p>
    <p class="c3"><span
            style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 786.88px; height: 390.46px;"><img
                alt="" src="images/image6.png"
                style="width: 786.88px; height: 390.46px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);"
                title=""></span></p>
    <p class="c2"><span class="c0">We can also visualize the training process with these images:</span></p>
    <p class="c3"><span
            style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 288.00px; height: 197.73px;"><img
                alt="" src="images/image30.png"
                style="width: 288.00px; height: 197.73px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);"
                title=""></span><span
            style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 288.00px; height: 197.73px;"><img
                alt="" src="images/image5.png"
                style="width: 288.00px; height: 197.73px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);"
                title=""></span><span
            style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 288.00px; height: 197.73px;"><img
                alt="" src="images/image13.png"
                style="width: 288.00px; height: 197.73px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);"
                title=""></span></p>
    <p class="c3"><span class="c4">Iteration
            0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Iteration
            10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Iteration
            50</span></p>
    <p class="c3"><span
            style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 288.00px; height: 197.73px;"><img
                alt="" src="images/image20.png"
                style="width: 288.00px; height: 197.73px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);"
                title=""></span><span
            style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 288.00px; height: 197.73px;"><img
                alt="" src="images/image4.png"
                style="width: 288.00px; height: 197.73px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);"
                title=""></span><span
            style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 288.00px; height: 197.73px;"><img
                alt="" src="images/image28.png"
                style="width: 288.00px; height: 197.73px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);"
                title=""></span></p>
    <p class="c3"><span class="c12">Iteration
            100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Iteration
            250&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Iteration
            500</span></p>
    <p class="c3"><span
            style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 288.00px; height: 197.73px;"><img
                alt="" src="images/image10.png"
                style="width: 288.00px; height: 197.73px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);"
                title=""></span></p>
    <p class="c3"><span class="c4">Iteration 1000</span></p>
    <p class="c2 c5"><span class="c0"></span></p>
    <p class="c2"><span class="c0">I also tried tuning the hyperparameters to see if I could get a better result, but
            none were better to the naked eye. I really like the first set, because you can see how lowering L gets rid
            of some of the higher frequencies. Some of the parameters didn&rsquo;t work potentially because of too few
            iterations, but oh well.</span></p>
    <p class="c2 c5"><span class="c0"></span></p>
    <p class="c3"><span
            style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 384.00px; height: 257.28px;"><img
                alt="" src="images/image23.png"
                style="width: 384.00px; height: 257.28px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);"
                title=""></span></p>
    <p class="c3"><span class="c4">L = 5, 4 hidden layers, 5k batch size, 3k iterations, 5e-3 lr</span></p>
    <p class="c3 c5"><span class="c4"></span></p>
    <p class="c3"><span
            style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 384.00px; height: 257.73px;"><img
                alt="" src="images/image29.png"
                style="width: 384.00px; height: 257.73px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);"
                title=""></span><span
            style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 384.00px; height: 257.73px;"><img
                alt="" src="images/image35.png"
                style="width: 384.00px; height: 257.73px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);"
                title=""></span></p>
    <p class="c3"><span class="c4">L = 10, 2 hidden layers, 5k batch size, 4k iterations, 1e-3
            lr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;L = 10, 2 hidden layers, 50k batch size, 500 iterations,
            1e-2 lr</span></p>
    <p class="c3 c5"><span class="c4"></span></p>
    <p class="c3"><span
            style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 384.00px; height: 257.73px;"><img
                alt="" src="images/image14.png"
                style="width: 384.00px; height: 257.73px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);"
                title=""></span><span
            style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 384.00px; height: 257.73px;"><img
                alt="" src="images/image17.png"
                style="width: 384.00px; height: 257.73px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);"
                title=""></span></p>
    <p class="c3"><span class="c4">L = 20, 2 hidden layers, 20k batch size, 1.5k iterations, 1e-2
            lr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp;L = 15, 3 hidden layers, 10k batch size, 1k
            iterations, 2e-2 lr</span></p>
    <p class="c2 c5"><span class="c0"></span></p>
    <p class="c2"><span class="c0">And here it is on another image</span></p>
    <p class="c3"><span
            style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 384.00px; height: 512.26px;"><img
                alt="" src="images/image3.png"
                style="width: 384.00px; height: 512.26px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);"
                title=""></span><span
            style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 384.00px; height: 509.95px;"><img
                alt="" src="images/image9.png"
                style="width: 384.00px; height: 509.95px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);"
                title=""></span></p>
    <p class="c3"><span
            class="c0">Original&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Predicted</span>
    </p>
    <p class="c3 c5"><span class="c0"></span></p>
    <p class="c3"><span
            style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 192.00px; height: 251.65px;"><img
                alt="" src="images/image7.png"
                style="width: 192.00px; height: 251.65px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);"
                title=""></span><span
            style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 192.00px; height: 251.65px;"><img
                alt="" src="images/image33.png"
                style="width: 192.00px; height: 251.65px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);"
                title=""></span><span
            style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 192.00px; height: 251.65px;"><img
                alt="" src="images/image15.png"
                style="width: 192.00px; height: 251.65px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);"
                title=""></span><span
            style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 192.00px; height: 251.65px;"><img
                alt="" src="images/image37.png"
                style="width: 192.00px; height: 251.65px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);"
                title=""></span><span
            style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 192.00px; height: 251.65px;"><img
                alt="" src="images/image36.png"
                style="width: 192.00px; height: 251.65px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);"
                title=""></span><span
            style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 193.50px; height: 252.00px;"><img
                alt="" src="images/image21.png"
                style="width: 193.50px; height: 252.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);"
                title=""></span><span
            style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 192.00px; height: 251.65px;"><img
                alt="" src="images/image26.png"
                style="width: 192.00px; height: 251.65px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);"
                title=""></span></p>
    <p class="c3 c5"><span class="c0"></span></p>
    <p class="c3 c5"><span class="c0"></span></p>
    <h1 class="c9" id="h.9n6ueh9pm1tc"><span class="c6">Part 2: Fit a Neural Radiance Field from Multi-view
            Images</span></h1>
    <p class="c1 subtitle" id="h.wpun1a11fl4f"><span class="c7">Create Rays from Cameras</span></p>
    <p class="c2"><span class="c0">To start, I first needed to use the data given to generate rays that would do the
            sampling. To do this I first made 2 helper functions. transform(c2w, x_c) which transforms camera
            coordinates to world coordinates, pixel_to_camera(K, uv, s) which converts pixel coordinates into camera
            coordinates. </span></p>
    <p class="c2 c5"><span class="c0"></span></p>
    <p class="c2"><span class="c0">The transform function solves the following problem given the inverse of the central
            matrix, also known as the camera-to-world transformation matrix.</span></p>
    <p class="c3"><span
            style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 232.00px; height: 124.00px;"><img
                alt="" src="images/image32.png"
                style="width: 232.00px; height: 124.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);"
                title=""></span></p>
    <p class="c2 c5"><span class="c0"></span></p>
    <p class="c2"><span>The pixel_to_camera function creates the intrinsic matrix </span><span class="c8">K</span><span
            class="c0">&nbsp;defined below using the focal length and principal point of our cameras. Then, we use it to
            solve for x_c and y_c in our equation where (u, v) are the coordinates in camera space and s is the depth
            along the optical axis.</span></p>
    <p class="c3"><span
            style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 219.00px; height: 111.00px;"><img
                alt="" src="images/image1.png"
                style="width: 219.00px; height: 111.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);"
                title=""></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span
            style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 177.00px; height: 108.00px;"><img
                alt="" src="images/image34.png"
                style="width: 177.00px; height: 108.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);"
                title=""></span></p>
    <p class="c2 c5"><span class="c0"></span></p>
    <p class="c1 subtitle" id="h.rawf36jnft7q"><span class="c7">Sampling</span></p>
    <p class="c2"><span class="c0">Next, we need to use these functions to sample points in 3d space. We first generate
            rays that correspond to certain pixels of our camera. I use the function pixel_to_ray(K, c2w, uv), which
            uses the helper functions to turn a camera pixel into a world space ray. For simplicity, I used s = 1. I
            then created a helper class to easily select pixels to sample. To do this, it first randomly selects a
            camera from the dataset, then randomly selects some coordinates within the image size, and then uses the
            aforementioned function to generate the ray. Now that I had my rays, I needed to get 3d coordinates, and so
            I sampled points along that ray (in the range the object exists in) with slight random variances to help
            with training. I also keep track of the actual color value of that pixel to calculate the loss.</span></p>
    <p class="c1 subtitle" id="h.evd3h2rlqyvk"><span>Neural Radiance Field</span></p>
    <p class="c2"><span class="c0">Now onto the machine learning part of things. For this, I used a much larger MLP than
            with the 2d image. The network takes in x, the 3d coordinates of the point we&rsquo;re sampling, and r_d,
            the ray&rsquo;s direction. It then outputs density and color of the pixel, which helps with rendering later.
            I concatenated the input after PE to the middle of the MLP so that it would adhere more closely to the
            prompt, as it is a large network.</span></p>
    <p class="c2 c5"><span class="c0"></span></p>
    <p class="c3"><span
            style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 672.00px; height: 218.01px;"><img
                alt="" src="images/image22.png"
                style="width: 672.00px; height: 218.01px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);"
                title=""></span></p>
    <p class="c3 c5"><span class="c0"></span></p>
    <p class="c1 subtitle" id="h.mercqzxfbr5n"><span class="c7">Volume Rendering</span></p>
    <p class="c2"><span class="c0">To render the model&rsquo;s output, I used volume rendering. This was a new form of
            rendering I hadn&rsquo;t seen before built around the following equation:</span></p>
    <p class="c3"><span
            style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 663.00px; height: 78.00px;"><img
                alt="" src="images/image11.png"
                style="width: 663.00px; height: 78.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);"
                title=""></span></p>
    <p class="c2"><span class="c0">Since I&rsquo;d rather not need to solve an integral every time I render something, I
            used the discrete form</span></p>
    <p class="c3"><span
            style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 588.00px; height: 89.00px;"><img
                alt="" src="images/image16.png"
                style="width: 588.00px; height: 89.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);"
                title=""></span></p>
    <p class="c2"><span class="c0">After some mild debugging and head banging on my desk, I got this working.</span></p>
    <p class="c1 subtitle" id="h.mw5clj73kh5d"><span class="c7">Training</span></p>
    <p class="c2"><span class="c0">Training my model was so incredibly annoying. So many tiny bugs led to huge problems,
            and no set of hyperparameters seemed to work well. My model wouldn&rsquo;t train at all with a scheduler,
            and hardware limitations capped out my batch size at around 8k and 32 samples per ray. I tried using
            sub-batches to increase these, but ended up just increasing the number of gradient steps. The model that
            finally worked used an Adam optimizer with a learning rate of 5e-4, 3k gradient steps, 8k batch size, and 32
            samples per ray. Due to hardware and time limitations, I couldn&rsquo;t train the final model for the 2.5
            hours recommended. This resulted in the following loss and PSNR.</span></p>
    <p class="c2 c5"><span class="c0"></span></p>
    <p class="c3"><span
            style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 770.50px; height: 208.51px;"><img
                alt="" src="images/image8.png"
                style="width: 770.50px; height: 208.51px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);"
                title=""></span></p>
    <p class="c3 c5"><span class="c0"></span></p>
    <p class="c2"><span class="c0">Each sample I&rsquo;m testing a lot of arrays, but here&rsquo;s a visualization of
            just 100,</span></p>
    <p class="c2 c5"><span class="c0"></span></p>
    <p class="c3"><span
            style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 711.50px; height: 535.74px;"><img
                alt="" src="images/image24.png"
                style="width: 711.50px; height: 535.74px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);"
                title=""></span></p>
    <p class="c2 c5"><span class="c0"></span></p>
    <p class="c2"><span class="c0">Due to hardware and timing constraints, I couldn&rsquo;t train the model with the
            batch size I did and generate the PSNR curve on the validation set for my finalized model. Instead
            I&rsquo;ve trained a model with a 2k batch size, 500 iterations, and everything else that same. I have the
            PSNR curve on the validation set for that. It&rsquo;s interesting to see that it&rsquo;s higher than the
            training PSNR.</span></p>
    <p class="c2 c5"><span class="c0"></span></p>
    <p class="c3"><span
            style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 384.00px; height: 200.76px;"><img
                alt="" src="images/image19.png"
                style="width: 384.00px; height: 200.76px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);"
                title=""></span><span
            style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 378.75px; height: 206.47px;"><img
                alt="" src="images/image27.png"
                style="width: 760.54px; height: 206.47px; margin-left: -381.79px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);"
                title=""></span></p>
    <p class="c2 c5"><span class="c0"></span></p>
    <p class="c2"><span class="c0">Finally, here is a rendering from my finalized model!</span></p>
    <p class="c2 c5"><span class="c0"></span></p>
    <p class="c3"><span
            style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 200.00px; height: 200.00px;"><img
                alt="" src="images/image18.gif"
                style="width: 200.00px; height: 200.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);"
                title=""></span></p>
    <p class="c1 subtitle" id="h.op3g2y3oo40e"><span class="c7">Bells &amp; Whistles</span></p>
    <p class="c2"><span class="c0">As my Bells &amp; Whistles, I added a way to customize the background of the render.
            I did this by passing in the desired color, and replacing all pixels that only received a density of 0 with
            that color. It doesn&rsquo;t look as good as a black background because the minor mistakes where it has very
            near 0 density still get colored near black, and those stand out more.</span></p>
    <p class="c2 c5"><span class="c0"></span></p>
    <p class="c3"><span
            style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 200.00px; height: 200.00px;"><img
                alt="" src="images/image25.gif"
                style="width: 200.00px; height: 200.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);"
                title=""></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span
            style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 202.66px; height: 202.66px;"><img
                alt="" src="images/image31.gif"
                style="width: 202.66px; height: 202.66px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);"
                title=""></span></p>
    <p class="c3 c5"><span class="c0"></span></p>
    <p class="c2"><span>I also implemented what I think was a depth map, though I&rsquo;m not sure the implementation
            was correct and I accidentally saved something over the rendering, so I don&rsquo;t have that. It&rsquo;s
            also currently 15 minutes before the deadline and I&rsquo;m generating the validation PSNR graph which
            should take another 10 minutes, so I can&rsquo;t regenerate it.</span></p>
</body>

</html>